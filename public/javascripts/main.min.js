app={},$(function(){app.init()}),app.init=function(){app.initFluid();var t=panzoom(document.getElementById("stadiumSVG"),{smoothScroll:!1});app.zoomTribune(t),app.getEventsList(),app.checkEvent(),app.getTickets(1),app.endPreloading()},app.initFluid=function(){var t=1920;function e(){device.tablet()&&(t=768),device.mobile()&&(t=375),$("html").css({"font-size":Math.min($(window).width()/t*10,10)+"px"})}e(),$(window).on("resize",e)},app.calibrateTribune=function(t){var e=t[0],a=t[1],n={calibrateX:0,calibrateY:0};switch(e){case"W":n.calibrateX=30,n.calibrateY=-50;break;case"S":n.calibrateX=-50,n.calibrateY="E"===a?150:"W"===a?0:50;break;case"E":n.calibrateX=30,n.calibrateY=150;break;case"N":n.calibrateX=100,n.calibrateY="E"===a?150:"W"===a?0:50}return n},app.zoomTribune=function(a){$("[data-tribune]").each(function(){var e=$(this);e.on("click",function(){var t=app.calibrateTribune(e.data("tribune"));a.zoomAbs(e.offset().left+t.calibrateX,e.offset().top+t.calibrateY,2)})})},app.getEventsList=function(){$.get("/getevents",function(t){"success"===t.status&&t.events.forEach(function(t){$("select#eventsSelect").append('<option value="'+t.Name+'" data-event-id="'+t.ID+'">'+t.Name+"</option>")})})},app.checkEvent=function(){$("select#eventsSelect").change(function(){app.getTickets($("#eventsSelect option:selected").data("eventId"))})},app.getTickets=function(t){var e=$("[data-tribune]");t="undefined"!==t?t:1,e.each(function(){var a=$(this);a.on("click touchstart",function(){$.post("/getsectortickets",{IDEvent:t,SectorName:a.data("tribune")},function(t){if(0<t.TicketData.length){var e=t.TicketData[0].row_to_json;$.fancybox.open($("[data-popup]"),{beforeShow:function(){$("[data-popup-title]").text(e.SectorRu),$.get("../images/sectors/"+a.data("tribune")+".svg",null,function(t){$("svg",t).prependTo($("[data-popup-svg]"))},"xml")},afterClose:function(){$("[data-popup-svg]").html("")}})}else $.fancybox.open('<div class="popup t-a-c"><h2>Билетов в данной трибуне нет!</h2></div>')},"json")})})},app.endPreloading=function(){$("[data-preloader]").fadeOut(),$("html").css("overflow","visible")};